
\documentclass[DIV=calc, paper=letter, fontsize=11pt]{scrartcl}	 % A4 paper and 11pt font size

\usepackage[body={6.5in,9.0in},
  top=1.0in, left=1.0in]{geometry}
  
\usepackage[english]{babel} % English language/hyphenation
\usepackage[protrusion=true,expansion=true]{microtype} % Better typography
\usepackage{amsmath,amsfonts,amsthm} % Math packages
\usepackage[svgnames]{xcolor} % Enabling colors by their 'svgnames'
\usepackage[hang, small,labelfont=bf,up,textfont=it,up]{caption} % Custom captions under/above floats in tables or figures
\usepackage{booktabs} % Horizontal rules in tables
\usepackage{fix-cm}	 % Custom font sizes - used for the initial letter in the document

\usepackage{sectsty} % Enables custom section titles
\allsectionsfont{\usefont{OT1}{phv}{b}{n}} % Change the font of all section commands

\usepackage{fancyhdr} % Needed to define custom headers/footers
\pagestyle{fancy} % Enables the custom headers/footers
\usepackage{lastpage} % Used to determine the number of pages in the document (for "Page X of Total")

\usepackage{fancyvrb}% used to include files verbatim
%\usepackage{chemsym}

\usepackage{hyperref}

\usepackage[backend=bibtex,style=numeric,sorting=ydnt,maxnames=15]{biblatex}
\renewbibmacro{in:}{}

% Count total number of entries in each refsection
\AtDataInput{%
  \csnumgdef{entrycount:\therefsection}{%
    \csuse{entrycount:\therefsection}+1}}

% Print the labelnumber as the total number of entries in the
% current refsection, minus the actual labelnumber, plus one
\DeclareFieldFormat{labelnumber}{\mkbibdesc{#1}}    
\newrobustcmd*{\mkbibdesc}[1]{%
  \number\numexpr\csuse{entrycount:\therefsection}+1-#1\relax}


%\addbibresource[label=papers]{mypubs.bib}
%\addbibresource[label=books]{mypubs.bib}
%\addbibresource[label=edited]{mypubs.bib}
%\addbibresource[label=chapters]{mypubs.bib}


% Headers - all currently empty
\lhead{}
\chead{}
\rhead{}

% Footers
\lfoot{\textsf{EMSoft--2015} manual, Release 3.0, \today}
\cfoot{}
\rfoot{\footnotesize Page \thepage\ of \pageref{LastPage}} % "Page 1 of 2"

\renewcommand{\headrulewidth}{0.0pt} % No header rule
\renewcommand{\footrulewidth}{0.4pt} % Thin footer rule

\usepackage{lettrine} % Package to accentuate the first letter of the text
\newcommand{\initial}[1]{ % Defines the command and style for the first letter
\lettrine[lines=3,lhang=0.3,nindent=0em]{
\color{DarkGoldenrod}
{\textsf{#1}}}{}}

\usepackage{titling} % Allows custom title configuration

\newcommand{\HorRule}{\color{DarkGoldenrod} \rule{\linewidth}{1pt}} % Defines the gold horizontal rule around the title

\pretitle{\vspace{-1.5in} \begin{center} \HorRule \fontsize{25}{25} \usefont{OT1}{phv}{b}{n} \color{DarkRed} \selectfont} % Horizontal rule before the title

\title{EMSoft:\\ General User and\\ Development Manual} % Your article title

\posttitle{\par\end{center}\vskip 0.5em} % Whitespace under the title

\preauthor{\begin{center}\large \lineskip 0.5em \usefont{OT1}{phv}{b}{sl} \color{DarkRed}} % Author font configuration

\author{\vspace*{-0.7in}} % Your name

\postauthor{\footnotesize \usefont{OT1}{phv}{m}{sl} \color{Black} % Configuration for the institution name

\par\end{center}\HorRule} % Horizontal rule after the title
\date{Program Manual, Release 3.0, \today}

\newcommand{\ctp}{\textsf{EMSoft}}
\newcommand{\ctpb}{\textbf{\textsf{EMSoft}}}
%
\begin{document}
\maketitle

\renewcommand{\contentsname}{Table of Contents}
{\small\tableofcontents}

\newpage
\section{What is \ctpb?}
\ctp\ is an open source package for the simulation of electron microscopy imaging and diffraction modalities.  It consists of a library with
core routines for crystallography, symmetry, dynamical scattering, Monte Carlo simulations, and so on, plus a series of programs for the different modalities.
The package is based on the older, and now discontinued, \textsf{CTEMsoft} package, for which the version 2.0 source code is still
available at \textit{http://www.github.com/marcdegraef/CTEMsoft}.  This code base is no longer supported and is completely replaced
by a new source code base, version 3.0, available from \textit{http://www.github.com/marcdegraef/EMSoft}.  The two versions are not 
compatible with each other (with one exception; see section~\ref{sec:f90input5}).

This manual describes a few aspects of the \ctp\ package:
\begin{itemize}
\item how to install the software developer toolkit;
\item where to get the executables, if you don't want to compile things yourself;
\item the different ways of communicating with the programs (input files);
\item and a list of programs available in this release (3.0).
\end{itemize}

At the time of writing of this manual, these programs have been successfully compiled and executed on the Mac OS X platform (Yosemite) and on 
Linux CentOS 7 using the public domain gfortran compiler. There is no real reason why this code should not work on Windows systems, and efforts are underway
to make sure that the code will run on all platforms. Where appropriate, computations
are carried out using \textsf{OpenMP} directives, so that multiple cores are used.  In addition, several programs make use of a 
GPU (if available), using \textit{OpenCL} code.

If you wish to compile \ctp\ yourself, then please proceed with the next section; if you only plan on using the 
executables, please jump ahead to section~\ref{sec:executables}.


\section{The \ctpb\ Software Developer Kit\label{sec:SDK}}
If you wish to compile the package code yourself, then you will first need to pull the code base from github; you can 
clone the repository from \textit{http://www.github.com/marcdegraef/EMSoft}.  Select a location on your hard drive to 
host the source code tree; we recommend that the foldername be \ctp, but you are obviously free to change this.

Before you can start to compile the code, you must install the software developer kit (SDK).  This is made very easy thanks to our
friends at Bluequartz.net; open a terminal window, navigate inside the \ctp\ tree to the folder \textsf{Support/P\_Build\_Scripts},
where \textsf{P} represents your platform (e.g., OSX). On the Mac OS X platform, the SDK will be installed by default in the \textsf{/Users/Shared}
folder; this can be changed by editing the first entry in the \textsf{Build\_SDK.sh} shell script file.  For Linux systems, this 
script is nearly identical to the one on OS X, but the user may wish to create (with \textsf{sudo}) a \textsf{/Users/Shared/} folder first.

Once the appropriate folder has been selected, the build script should be executed with
\begin{verbatim}
	sudo ./Build_SDK.sh
\end{verbatim}
(Note that you will not need sudo access if you opt to place the SDK inside your home folder; if you do so, the SDK will not be accessible
to other users.) This shell script will first download the \textsf{EMSoft\_SDK} archive from one of the BlueQuartz web servers and install
and unpack the archive. Then the script will start the compilation process for the following libraries:
\begin{itemize}
\item \textsf{CMake}: CMake is a package that manages the entire compilation process.  To make sure that the correct version is used, it is installed first.
\item \textsf{jsonfortran}: a small library to parse and create json-formatted files (JavaScript Object Notation);
\item \textsf{HDF5}: a large library for Hierarchical Data Format support; note that this library will be compiled twice, once in debug mode and once in release mode.
It is normal for there to be a large number of warnings during the compilation; just ignore them.
\item \textsf{fortrancl}: another small library with wrapper routines to call OpenCL from within f90 programs.
\end{itemize}
All four of these packages should compile and install without any issues, assuming that you have the correct compilers on your system.  Note that the 
installation is sandboxed, i.e., it will not interfere with or overwrite any existing implementations of these libraries;  you should only use the libraries
inside the sandbox, though.

Once the SDK has been compiled, you will be ready to compile \ctp, as described in the next section.

\section{Compiling \ctpb\label{sec:compile}}
Add the location of the bin folder inside the SDK to your path variable; this will depend on your operating system and the type 
of shell you are using.  For Mac OS X, the command is as follows (assuming the default SDK location):
\begin{verbatim}
	export PATH=$PATH:/Users/Shared/EMSoft_SDK/cmake-3.3.1-Darwin-x86_64/CMake.app/Contents/bin/
\end{verbatim}
Typically, you would add this line, or a similar one for other shells, to your \textsf{.bashrc} or \textsf{.cshrc} file.

In a terminal window, cd to your \textsf{EMsoft} top folder, create a \textit{Build} folder, cd inside it and enter the following command:
\begin{verbatim}
	cmake -DEMSoft_SDK=/Users/Shared/EMSoft_SDK -DCMAKE_BUILD_TYPE=Debug ../
\end{verbatim}
This will spit out a number of variables and path names.\footnote{If you get any error messages or notice things that do not look right, please contact us with a 
screen dump as well as a description of your systemm, including the OS version.}  Then type
\begin{verbatim}
	make -j
\end{verbatim}
to compile the entire library and all the executables.  From here on, you can start editing the source code and recompile things as needed.


\section{Installation Instructions\label{sec:todo}}
If you chose not to compile the code, and you only wish to execute the programs, or you did perform the steps in the last two sections, you will
now need to set up your environment so that the executables will be found, 



In the older version of CTEMsoft, the programs required several environment variables to be set, so
that all the resource files and such could be located. In the present pre-release, this has been changed
to a more flexible system that should work on all platforms (OS X, Linux and Windows).  There are 
only two variables that need to be set in order for the programs to function properly.  They are defined 
via the \textsf{EMsoftConfig.json} file, located inside the hidden \textsf{.config/EMsoft} folder in the user's 
home directory.

\begin{enumerate}
\item Place the \textsf{EMsoft.zip} archive somewhere inside your home folder; for instance, if your username is ``me,'' you could create 
a folder named \textsf{packages} inside the \textsf{/Users/me} folder, and put the archive inside \textsf{/Users/me/packages}.
Then unpack the archive, which will create en \textsf{EMsoft} folder containing several other folders.

\item Check whether or not the folder \textsf{/opt/local/lib/libgcc} exists on your system; if it does not,
create it (you will need to execute a \textsf{sudo} command to do so, or ask the system admin to 
create it for you.  Then, check whether or not the files inside the \textsf{EMsoft/lib} folder are present 
in the \textsf{/opt/local/lib/libgcc} folder; if they are not, copy them from \textsf{EMsoft/lib}.

\item Check whether or not the \textsf{.config} folder exists in your home folder; if it doesn't exist, create it (don't forget the 
period in front of the folder name). Then go into this folder and create the \textsf{EMsoft} folder; go into
that folder and create a \textsf{tmp} folder.  Then, at the same level as the tmp folder, use a text editor to
create a file with the name \textsf{EMsoftConfig.json} and enter the following four lines:
\begin{verbatim}
{
        "EMsoftpathname" : "/full/path/to/the/top/EMsoft/installation/folder/",
        "EMdatapathname" : "/full/path/to/the/EMsoft/data/folder/" 
}
\end{verbatim}
Note that the white space at the start of lines 2 and 3 is a tab.  Obvisouly, you will need to change the paths above.
Typically, the installation folder would be somewhere below your home folder, so on Mac OS X for instance, this 
could be \textsf{/Users/me/packages/EMsoft/};  note that the path must be terminated with a \textsf{/}.
The second variable indicates where you will keep your data files, i.e., all the files generated by the \ctp\ programs.
This folder must be outside of the main \ctp-tree, so that no data will be overwritten when future updates or releases
become available.  Create a top data folder, for instance \textsf{/Users/me/Data/EMplay/}.  Then, inside this folder,
create an additional folder with the name \textsf{XtalFolder}; this is where all the crystal structure descriptor files 
will be kept.  Whenever the user specifies the location of a data file, this location is always a relative pathname
with respect to the \textsf{EMdatapathname} location;  so, if we have \textsf{EMdatapathname} set to \textsf{/Users/me/Data/EMplay/},
and we wish to create a data file with absolute pathname \textsf{/Users/me/Data/EMplay/Silicon/EBSDmaster.h5}, then
the relative pathname will be \textsf{Silicon/EBSDmaster.h5}.  This makes it possible to exchange data files 
between users or transfer files from one system to another.

\item Adjust the PATH variable so that your shell will find the executables in the \textsf{EMsoft/bin} folder.  You can either do this via your shell setup files (e.g., \textsf{.cshrc}
or \textsf{.bashrc}), or via the system wide \textsf{/etc/paths} file (which will require \textsf{sudo} access).
The syntax will depend a little on which shell you are using (for UNIX-based systems).  Note that the UNIX flavor on Mac OS X 
is not case-sensitive for file and folder names; on all other UNIX-flavored platforms, filenames and folders \textit{are}
case-sensitive.

\item To view the HDF5 formatted data files, you may wish to install the free HDF5 viewer.  First you need to have Java installed (if it isn’t already):
for Mac OS X, go to 
\begin{verbatim}
https://java.com/en/download/faq/java_mac.xml
\end{verbatim}
to install Java.  Then download the HDF5 viewer app from
\begin{verbatim}
http://www.hdfgroup.org/products/java/release/download.html;
\end{verbatim}
scroll down to Max OS X.
The HDF5 files can also be read by any other program that supports this format, e.g., IDL, Matlab, etc...
\end{enumerate}


\newpage
\section{The general structure of EMsoft programs\label{sec:structure}}
Each \ctp\ program has the same high level source code structure, and is called in the same way.  If \textsf{EMprogram} represents 
a program name (for instance \textsf{EMECP} or \textsf{EMlacbed}, then the following command line options can be used (all of them optional):
\begin{verbatim}
	EMprogram [-h] [-t] [file.nml]
\end{verbatim}
The arguments  between square brackets are optional, and are defined as follows:
\begin{itemize}
	\item \textsf{-h}: (h=help) this argument causes the program to display a list of all command line arguments and their meaning.  The program will quit after printing 
	the help message.
	\item \textsf{-t}: (t=template) this argument causes the program to create template files for all the input files used by the program.  For each
	name-value entry in the template file (see section~\ref{sec:f90input} for more details), a comment line is inserted with a brief explanation 
	of the variable and its units, if appropriate.  The user can then copy the template file to a new file with the namelist (.nml) extension and edit the 
	file with a regular text editor.  The program will quit after generating the template files.  Each template file contains the default values for each parameter.
	If this option produces an error, then this is likely due to an incorrect setting of the shell variables in the previous section.
	\item \textsf{file.nml}: the main namelist file to be used by the program.  If no name is present, then the default filename \textsf{EMprogram.nml} will be used.  If the 
	provided namelist file does not exist, the program will report an error and abort.
\end{itemize}

The programs in the top half of the table on the last page of this manual function in the way described above; all other programs
have a simple command line interface, with user prompts for all relevant variables.  Eventually, in a future release, all programs
will make use of namelist or json input files and will likely be callable from a single user interface.


\newpage
\section{Program input files\label{sec:f90input}}
All user input for the \ctp\ programs is performed either via namelist files or via json files; the namelist is a special f90 IO format that allows one to list 
\textit{name-value} pairs in an ordinary text file, and then this file will be read and interpreted by the 
program.  The basic format of a namelist file is as follows:
\begin{verbatim}
&nmlname
var1 = val1
var2 = val2
...
/
\end{verbatim}
The first line must begin with the ampersand character ``\&'' and is followed (without spaces) by the internal name used by the program 
to identify the set of variables (this is similar to a \textit{common block} in the older f77 standard).  After the mandatory first line, which should not be altered, a 
list of name-value pairs follows.  These can appear in any order, and variables may be omitted from the file, in which case the program
will use a default value (this value can be found in the template file; see section~\ref{sec:structure}).  The final line of the file must contain a single forward slash
character, ``/'', to end the namelist.

The json format (JavaScript Object Notation) is an xml-like version of the name-value pairs, and is very similar to the namelist format, with the exception 
of the presence of curly braces.  For the example namelist file shown above, the equivalent json file would look as follows:
\begin{verbatim}
{
        "nmlname": {
        	        "var1": val1,
        	        "var2": val2,
                ...		
        }
}
\end{verbatim}
The \ctp\ programs automatically detect which format of input file is used, so either one is fine.  The json formatted input files 
will in a future release be generated by a number of filters in the \textsf{DREAM.3D} software package, whereas the namelist formatted 
files must be edited by hand, starting from the template files (created with option -t).\\


As a concrete example, consider the namelist file used to define a dislocation:
\begin{Verbatim}%
	[formatcom=\color{blue},frame=lines]
&dislocationdata
id = 0.501
jd = 0.501
u = 1.0,0.0,1.0
bv = 0.5,0.0,0.5
/
\end{Verbatim}
Internally, the program identifies this set of variables with the namelist identifier ``dislocationdata,'' as shown on the first line of the file.
Then there are four name-value pairs: \textsf{id} and \textsf{jd} are real numbers in the range $[-1,1]$ and define the position
of the defect; \textsf{u} represents the line direction, which is declared as a triplet of 
floating point numbers; and the burgers vector is represented by another triplet of floating point numbers and the variable name \textsf{bv}.
The forward slash closes the file.  Note that these entries can appear in any order. Comment lines are allowed in the namelist
file; simply start the line with the f90 comment character (the exclamation mark ``!'') and then type your comment.  For variables that 
have components, such as the two vectors above, one may also define each component separately, in which case the file would look
as follows:
\begin{verbatim}
&dislocationdata
id = 0.501
jd = 0.501
! these vectors are defined one component at a time
u(1) = 1.0 
u(2) = 0.0 
u(3) = 1.0
bv(1) = 0.5
bv(2) = 0.0
bv(3) = 0.5
/
\end{verbatim}
It is not necessary to leave spaces before and after the ``='' symbol, but it does improve the readability of the namelist file to do so. Since 
one can always recover the template file(s) by using the [-t] option when calling the program, there is no need to list all the name-value pairs
in the namelist file; pairs which are not listed will take on their default value(s), which are the ones listed in the template file.

One important thing to note: when entering file names and other strings in name list files, one must use single quotes both at the start and at 
the end of the string.  Some word processing programs have so-called ``smart quotes'' settings, which will introduce a different kind of quote,
and the fortran programs will not recognize smart quotes as being the same as single quotes.  Therefore, turn off the ``smart quotes'' option
in your editor before you start editing namelist or json files.

\newpage
\section{Generating a crystal structure file\label{sec:f90input5}}

With very few exceptions, all programs in the \ctp\ suite of programs require a crystallographic input file that defines the 
crystal system, crystal lattice parameters, space group number, and all unique positions in the 
asymmetric unit along with site occupations and Debye-Waller parameters.  To keep things simple and 
portable across platforms, structure description files (*.xtal) are small HDF5-formatted files that contain the minimum
amount of information needed to unambiguously define the complete unit cell.  

To create a crystal structure description file, one uses the \textsf{EMmkxtal} program, which will prompt
the user for the crystal system number, the lattice parameters (in nm and degrees), the space group number,
and the atom positions in the asymmetric unit.  Each atom entry is defined by five numbers: the fractional
coordinates (which can be entered as real numbers or as fraction, e.g., $0.5$ or $1/2$), the site 
occupation parameter (a real number between $0$ and $1$), and the isotropic Debye-Waller factor in nm$^{2}$.

Once all atoms in the asymmetric unit have been entered, the program will ask for a structure file name; we
recommend that all such files have the extension \textsf{.xtal}, to make them easily recognizable.  All .xtal files
will be automatically placed in the \textsf{XtalFolder} inside the main \ctp\ data folder.
%
%With very few exceptions, all programs in the \ctp\ suite of programs require a crystallographic input file that defines the 
%crystal system, crystal lattice parameters, space group number, and all unique positions in the 
%asymmetric unit along with site occupations and Debye-Waller parameters.  To keep things simple and 
%portable across platforms, structure description files (*.ctem) are simple editable text files that contain the minimum
%amount of information needed to unambiguously define the complete unit cell.
%
%The crystal structure definition file format is best illustrated with a few examples.  Consider first a simple face-centered 
%cubic unit cell for copper:
%\fvset{frame=lines,formatcom=\color{blue},fontsize=\footnotesize,numbers=left}
%%\VerbatimInput{../resources/Cu.xtal}
%\begin{itemize}
%\item The first line contains the crystal system number (1 integer), using the following values:
%cubic=1, tetragonal=2, orthorhombic=3, hexagonal=4, trigonal=5, monoclinic=6, and triclinic=7.
%\item The second line contains the space group number (1 integer), potentially followed by a second integer (see later).
%\item The third line lists the lattice parameters $\{a,b,c,\alpha,\beta,\gamma\}$ (6 reals; lengths in  nm; angles in degrees);
%\item The fourth line contains the number of atoms in the asymmetric unit (1 integer);
%\item The remaining lines (as many as indicated on line 4) each have six numbers, the first one an integer, the others reals.
%The first number is the atomic number, followed by three fractional coordinates, the site occupation number (in the interval $[0,1]$),
%and the isotropic Debye-Waller factor (in nm$^2$).  The fractional coordinates may be entered either as reals (e.g., $0.23$) or as fractions
%(e.g., $1/3$, $7/12$, etc.).
%\end{itemize}
%The structure file can be generated manually, or it can be generated by means of the \textsf{CTEMxtal} program, which prompts the 
%user for all relevant parameters and then creates the file in the appropriate format.
%
%A more complex example is the structure of tetragonal BaTiO$_3$:
%\fvset{frame=lines,formatcom=\color{blue},fontsize=\footnotesize,numbers=left}
%\VerbatimInput{../xtal/BaTiO3.xtal}
%Note that all lines after the last atom position line are ignored by the \ctp\ programs, so that one can add any relevant comment lines. 
%
%For space groups with two origin settings, special care is needed when defining the space group number.
%
%Finally, for trigonal space groups, one can define the lattice parameters in terms of the rhombohedral unit cell or a hexagonal unit 
%cell.  The \ctp\ programs will check the value of the $\gamma$ unit cell angle; if $\gamma=120^{\circ}$, then the hexagonal setting
%will be taken, otherwise the rhombohedral unit cell will be assumed.
%

\section{List of programs}
The list below shows all the available programs in the current Release (2.0) of the \ctp\ suite, along with whether or not there is a 
separate manual for each program.  Programs for which no manual is available are generally relatively easy to figure out.
In the current release, many programs still have a command-line interaction with the user; this will be modified
in the next release so that all programs will eventually make use of namelist files.  The top half of the table
lists those programs for which an extensive manual is available, as well as IDL visualization routines. The \textsf{EMmkxtal}
program is explained in the present document.  The other programs do not yet have manual pages, but are generally 
simple to figure out.  Many of the programs in the bottom half of the table are simple illustrations of how 
to perform certain computations.

%All it takes is to run the program with the \textit{-t} option, to create a template namelist file in the current folder;
%you can then edit this file to set the appropriate parameters, and 

\begin{table*}[h]
\centering\leavevmode
\begin{tabular}{|l|l|c|}
\hline
Program & Short description & Manual? \\
\hline\hline
  \textsf{EMlacbed} & large angle CBED pattern computation (TEM)& $\checkmark$ \\
  \textsf{EMmbcbed} & regular CBED pattern (TEM)& $\checkmark$\\
  \textsf{EMSRdefect} & (S)TEM systematic row defect images (TEM) & $\checkmark$\\
  \textsf{EMZAdefect} & (S)TEM zone axis defect images (TEM) & $\checkmark$\\
  \textsf{EMECP} & electron channeling pattern (SEM) & $\checkmark$\\
  \textsf{EMECCI} & ECCI defect images (SEM) & $\checkmark$\\
  \textsf{EMKossel} & electron Kossel patterns (SEM) & $\checkmark$\\
  \textsf{EMMC} & Monte Carlo trajectory simulations (SEM) & $\checkmark$\\
  \textsf{EMEBSDmaster} & EBSD master pattern simulation (SEM) & $\checkmark$\\
  \textsf{EMEBSD} & EBSD pattern simulation (SEM) & $\checkmark$\\
\hline
  \textsf{EMmkxtal} & make a crystal structure input file& $\checkmark$\\
  \textsf{EMlistSG} & list the equivalent positions of any space group & \\
  \textsf{EMqg} & list Fourier coefficient information & \\
  \textsf{EMfamily} & draw a family of planes (stereographic) & \\
  \textsf{EMstar} & list the star of any reciprocal lattice point & \\
  \textsf{EMorbit} & list the orbit of a point & \\
  \textsf{EMZAgeom} & print zone axis geometry and symmetry information & \\
  \textsf{EMlatgeom} & perform some simple lattice geometry calculations & \\
  \textsf{EMstereo} & basic stereographic prpjection tool & \\
  \textsf{EMorient} & stereographic projection for orientation relation & \\
  \textsf{EMxtalinfo} & makes postscript file with lots of information & \\
  \textsf{EMzap} & create postscript file with zone axis patterns & \\
  \textsf{EMdrawcell} & draw a unit cell (very primitive) & \\
\hline
\end{tabular}
\end{table*}





\end{document}



